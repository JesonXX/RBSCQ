<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>审计部工作日报生成器</title>
    <style>
        body {
            font-family: 'FangSong', '仿宋', 'Fangsong', serif;
            font-size: 12pt;
            line-height: 1.4;
            margin: 0;
            padding: 20px;
            background-color: white;
            color: black;
            text-align: left;
            word-break: keep-all;
            white-space: pre-wrap;
        }
        .container {
            max-width: 210mm;
            margin: 0 auto;
            padding: 20mm;
            box-sizing: border-box;
            border: 1px solid #ccc;
            min-height: 297mm;
        }
        .title {
            font-family: 'FangSong', '仿宋', serif;
            font-size: 16pt;
            font-weight: bold;
            color: red;
            text-align: center;
            margin-bottom: 10mm;
            letter-spacing: 0.5pt;
        }
        .subtitle {
            font-family: 'FangSong', '仿宋', serif;
            font-size: 12pt;
            text-align: center;
            margin-bottom: 5mm;
        }
        .subtitle-line {
            border-bottom: 1px solid black;
            padding-bottom: 2mm;
            margin-top: -2mm;
        }
        .group-date {
            display: flex;
            justify-content: space-between;
            font-family: 'FangSong', '仿宋', serif;
            font-size: 12pt;
            margin-bottom: 5mm;
            font-weight: normal;
        }
        .section {
            font-family: 'FangSong', '仿宋', serif;
            font-size: 12pt;
            margin-bottom: 5mm;
            white-space: pre;
        }
        .list-item {
            font-family: 'FangSong', '仿宋', serif;
            font-size: 12pt;
            line-height: 1.3;
            margin-bottom: 3mm;
            text-indent: -1em;
            padding-left: 1em;
        }
        .list-item ol {
            list-style: decimal;
            padding-left: 0;
            margin: 0;
        }
        .list-item li {
            margin-bottom: 3mm;
            white-space: pre-wrap;
        }
        .page-number {
            position: absolute;
            bottom: 20mm;
            right: 20mm;
            font-family: 'FangSong', '仿宋', serif;
            font-size: 10pt;
            color: #808080;
        }
        .form-group {
            margin-bottom: 10px;
        }
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .form-group textarea {
            width: 100%;
            height: 80px;
            font-family: 'FangSong', '仿宋', serif;
            font-size: 12pt;
            padding: 5px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        .generate-btn, .pdf-btn {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            font-size: 14pt;
            margin: 10px;
            border-radius: 4px;
        }
        .generate-btn:hover, .pdf-btn:hover {
            background-color: #0056b3;
        }
        .preview {
            margin-top: 20px;
            position: relative;
        }
        @media print {
            .form-group, .generate-btn, .pdf-btn { display: none; }
            .preview { position: static; }
        }
        @media (max-width: 600px) {
            .container {
                padding: 10mm;
                width: auto;
            }
            .title { font-size: 14pt; }
        }
    </style>
    <!-- html2pdf.js for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- 输入表单 -->
        <div class="form-section">
            <h2 style="font-family: 'FangSong', '仿宋', serif; font-size: 14pt;">生成日报</h2>
            <div class="form-group">
                <label for="group">小组名称：</label>
                <input type="text" id="group" value="现场审计12组" style="width: 200px; font-family: 'FangSong', '仿宋', serif; font-size: 12pt; padding: 5px;">
            </div>
            <div class="form-group">
                <label for="date">日期（自动填充今日，可手动修改）：</label>
                <input type="date" id="date" value="2025-11-07" style="font-family: 'FangSong', '仿宋', serif; font-size: 12pt; padding: 5px;">
            </div>
            <div class="form-group">
                <label for="item1">今日工作1：</label>
                <textarea id="item1">对辽阳支行开展资产分类审计，复核审计工作底稿，&#10;整理审计档案资料，交回调阅的审计资料。</textarea>
            </div>
            <div class="form-group">
                <label for="item2">今日工作2：</label>
                <textarea id="item2">对辽阳支行开展案件防控审计，复核审计工作底&#10;稿，整理审计档案资料，交回调阅的审计资料。</textarea>
            </div>
            <div class="form-group">
                <label for="item3">今日工作3：</label>
                <textarea id="item3">按照审计团队工作要求，梳理阜新海州支行、阜新支&#10;行和营口鲅鱼圈支行全面审计中违规问题划分情况。</textarea>
            </div>
            <button class="generate-btn" onclick="generateReport()">生成预览</button>
            <button class="pdf-btn" onclick="downloadPDF()" style="display: none;" id="pdfBtn">下载PDF</button>
        </div>

        <!-- 预览区域 -->
        <div class="preview" id="preview" style="display: none;">
            <div class="title" id="reportTitle">审计部工作日报</div>
            <div class="subtitle">
                <div class="group-date">
                    <span id="reportGroup">现场审计12组</span>
                    <span id="reportDate">2025年11月7日</span>
                </div>
                <div class="subtitle-line"></div>
            </div>
            <div class="section">一、 今日工作  </div>
            <div class="list-item">
                <ol id="reportList">
                    <li id="li1"></li>
                    <li id="li2"></li>
                    <li id="li3"></li>
                </ol>
            </div>
            <div class="page-number">- 1 -</div>
        </div>
    </div>

    <script>
        // 自动设置今日日期（当前为2025-11-08，可手动改）
        window.onload = function() {
            const today = new Date('2025-11-08');
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            document.getElementById('date').value = `${year}-${month}-${day}`;
        };

        function generateReport() {
            const group = document.getElementById('group').value;
            const dateInput = document.getElementById('date').value;
            const date = new Date(dateInput);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const chineseDate = `${year}年${month}月${day}日`;

            document.getElementById('reportGroup').textContent = group;
            document.getElementById('reportDate').textContent = chineseDate;

            const item1 = document.getElementById('item1').value.replace(/\n/g, '<br>');
            const item2 = document.getElementById('item2').value.replace(/\n/g, '<br>');
            const item3 = document.getElementById('item3').value.replace(/\n/g, '<br>');

            document.getElementById('li1').innerHTML = item1 + ' ';
            document.getElementById('li2').innerHTML = item2 + ' ';
            document.getElementById('li3').innerHTML = item3 + '    ';

            document.getElementById('preview').style.display = 'block';
            document.getElementById('pdfBtn').style.display = 'inline-block';
        }

        function downloadPDF() {
            const element = document.getElementById('preview');
            const opt = {
                margin: [20, 20, 20, 20],
                filename: '审计部工作日报-2025-11-07.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        }
    </script>
</body>
</html>